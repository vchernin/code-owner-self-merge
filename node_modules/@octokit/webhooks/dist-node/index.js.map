{"version":3,"file":"index.js","sources":["../dist-src/generated/webhook-names.js","../dist-src/event-handler/on.js","../dist-src/event-handler/wrap-error-handler.js","../dist-src/event-handler/receive.js","../dist-src/event-handler/remove-listener.js","../dist-src/event-handler/index.js","../dist-src/middleware/isnt-webhook.js","../dist-src/middleware/get-missing-headers.js","../dist-src/middleware/get-payload.js","../dist-src/sign/index.js","../dist-src/verify/index.js","../dist-src/middleware/verify-and-receive.js","../dist-src/middleware/middleware.js","../dist-src/middleware/index.js","../dist-src/index.js"],"sourcesContent":["// THIS FILE IS GENERATED - DO NOT EDIT DIRECTLY\n// make edits in scripts/generate-types.ts\nexport const emitterEventNames = [\n    \"*\",\n    \"error\",\n    \"check_run\",\n    \"check_run.completed\",\n    \"check_run.created\",\n    \"check_run.requested_action\",\n    \"check_run.rerequested\",\n    \"check_suite\",\n    \"check_suite.completed\",\n    \"check_suite.requested\",\n    \"check_suite.rerequested\",\n    \"code_scanning_alert\",\n    \"code_scanning_alert.appeared_in_branch\",\n    \"code_scanning_alert.closed_by_user\",\n    \"code_scanning_alert.created\",\n    \"code_scanning_alert.fixed\",\n    \"code_scanning_alert.reopened\",\n    \"code_scanning_alert.reopened_by_user\",\n    \"commit_comment\",\n    \"commit_comment.created\",\n    \"content_reference\",\n    \"content_reference.created\",\n    \"create\",\n    \"delete\",\n    \"deploy_key\",\n    \"deploy_key.created\",\n    \"deploy_key.deleted\",\n    \"deployment\",\n    \"deployment.created\",\n    \"deployment_status\",\n    \"deployment_status.created\",\n    \"fork\",\n    \"github_app_authorization\",\n    \"github_app_authorization.revoked\",\n    \"gollum\",\n    \"installation\",\n    \"installation.created\",\n    \"installation.deleted\",\n    \"installation.new_permissions_accepted\",\n    \"installation.suspend\",\n    \"installation.unsuspend\",\n    \"installation_repositories\",\n    \"installation_repositories.added\",\n    \"installation_repositories.removed\",\n    \"issue_comment\",\n    \"issue_comment.created\",\n    \"issue_comment.deleted\",\n    \"issue_comment.edited\",\n    \"issues\",\n    \"issues.assigned\",\n    \"issues.closed\",\n    \"issues.deleted\",\n    \"issues.demilestoned\",\n    \"issues.edited\",\n    \"issues.labeled\",\n    \"issues.locked\",\n    \"issues.milestoned\",\n    \"issues.opened\",\n    \"issues.pinned\",\n    \"issues.reopened\",\n    \"issues.transferred\",\n    \"issues.unassigned\",\n    \"issues.unlabeled\",\n    \"issues.unlocked\",\n    \"issues.unpinned\",\n    \"label\",\n    \"label.created\",\n    \"label.deleted\",\n    \"label.edited\",\n    \"marketplace_purchase\",\n    \"marketplace_purchase.cancelled\",\n    \"marketplace_purchase.changed\",\n    \"marketplace_purchase.pending_change\",\n    \"marketplace_purchase.pending_change_cancelled\",\n    \"marketplace_purchase.purchased\",\n    \"member\",\n    \"member.added\",\n    \"member.edited\",\n    \"member.removed\",\n    \"membership\",\n    \"membership.added\",\n    \"membership.removed\",\n    \"meta\",\n    \"meta.deleted\",\n    \"milestone\",\n    \"milestone.closed\",\n    \"milestone.created\",\n    \"milestone.deleted\",\n    \"milestone.edited\",\n    \"milestone.opened\",\n    \"org_block\",\n    \"org_block.blocked\",\n    \"org_block.unblocked\",\n    \"organization\",\n    \"organization.deleted\",\n    \"organization.member_added\",\n    \"organization.member_invited\",\n    \"organization.member_removed\",\n    \"organization.renamed\",\n    \"package\",\n    \"package.published\",\n    \"package.updated\",\n    \"page_build\",\n    \"ping\",\n    \"project\",\n    \"project.closed\",\n    \"project.created\",\n    \"project.deleted\",\n    \"project.edited\",\n    \"project.reopened\",\n    \"project_card\",\n    \"project_card.converted\",\n    \"project_card.created\",\n    \"project_card.deleted\",\n    \"project_card.edited\",\n    \"project_card.moved\",\n    \"project_column\",\n    \"project_column.created\",\n    \"project_column.deleted\",\n    \"project_column.edited\",\n    \"project_column.moved\",\n    \"public\",\n    \"pull_request\",\n    \"pull_request.assigned\",\n    \"pull_request.auto_merge_disabled\",\n    \"pull_request.auto_merge_enabled\",\n    \"pull_request.closed\",\n    \"pull_request.converted_to_draft\",\n    \"pull_request.edited\",\n    \"pull_request.labeled\",\n    \"pull_request.locked\",\n    \"pull_request.opened\",\n    \"pull_request.ready_for_review\",\n    \"pull_request.reopened\",\n    \"pull_request.review_request_removed\",\n    \"pull_request.review_requested\",\n    \"pull_request.synchronize\",\n    \"pull_request.unassigned\",\n    \"pull_request.unlabeled\",\n    \"pull_request.unlocked\",\n    \"pull_request_review\",\n    \"pull_request_review.dismissed\",\n    \"pull_request_review.edited\",\n    \"pull_request_review.submitted\",\n    \"pull_request_review_comment\",\n    \"pull_request_review_comment.created\",\n    \"pull_request_review_comment.deleted\",\n    \"pull_request_review_comment.edited\",\n    \"push\",\n    \"release\",\n    \"release.created\",\n    \"release.deleted\",\n    \"release.edited\",\n    \"release.prereleased\",\n    \"release.published\",\n    \"release.released\",\n    \"release.unpublished\",\n    \"repository\",\n    \"repository.archived\",\n    \"repository.created\",\n    \"repository.deleted\",\n    \"repository.edited\",\n    \"repository.privatized\",\n    \"repository.publicized\",\n    \"repository.renamed\",\n    \"repository.transferred\",\n    \"repository.unarchived\",\n    \"repository_dispatch\",\n    \"repository_dispatch.on-demand-test\",\n    \"repository_import\",\n    \"repository_vulnerability_alert\",\n    \"repository_vulnerability_alert.create\",\n    \"repository_vulnerability_alert.dismiss\",\n    \"repository_vulnerability_alert.resolve\",\n    \"secret_scanning_alert\",\n    \"secret_scanning_alert.created\",\n    \"secret_scanning_alert.reopened\",\n    \"secret_scanning_alert.resolved\",\n    \"security_advisory\",\n    \"security_advisory.performed\",\n    \"security_advisory.published\",\n    \"security_advisory.updated\",\n    \"sponsorship\",\n    \"sponsorship.cancelled\",\n    \"sponsorship.created\",\n    \"sponsorship.edited\",\n    \"sponsorship.pending_cancellation\",\n    \"sponsorship.pending_tier_change\",\n    \"sponsorship.tier_changed\",\n    \"star\",\n    \"star.created\",\n    \"star.deleted\",\n    \"status\",\n    \"team\",\n    \"team.added_to_repository\",\n    \"team.created\",\n    \"team.deleted\",\n    \"team.edited\",\n    \"team.removed_from_repository\",\n    \"team_add\",\n    \"watch\",\n    \"watch.started\",\n    \"workflow_dispatch\",\n    \"workflow_run\",\n    \"workflow_run.completed\",\n    \"workflow_run.requested\",\n];\n","import { emitterEventNames } from \"../generated/webhook-names\";\nfunction handleEventHandlers(state, webhookName, handler) {\n    if (!state.hooks[webhookName]) {\n        state.hooks[webhookName] = [];\n    }\n    state.hooks[webhookName].push(handler);\n}\nexport function receiverOn(state, webhookNameOrNames, handler) {\n    if (Array.isArray(webhookNameOrNames)) {\n        webhookNameOrNames.forEach((webhookName) => receiverOn(state, webhookName, handler));\n        return;\n    }\n    if (emitterEventNames.indexOf(webhookNameOrNames) === -1) {\n        console.warn(`\"${webhookNameOrNames}\" is not a known webhook name (https://developer.github.com/v3/activity/events/types/)`);\n    }\n    if (webhookNameOrNames === \"*\" || webhookNameOrNames === \"error\") {\n        const webhookName = webhookNameOrNames === \"*\" ? \"any\" : webhookNameOrNames;\n        console.warn(`Using the \"${webhookNameOrNames}\" event with the regular Webhooks.on() function is deprecated. Please use the Webhooks.on${webhookName.charAt(0).toUpperCase() + webhookName.slice(1)}() method instead`);\n    }\n    handleEventHandlers(state, webhookNameOrNames, handler);\n}\nexport function receiverOnAny(state, handler) {\n    handleEventHandlers(state, \"*\", handler);\n}\nexport function receiverOnError(state, handler) {\n    handleEventHandlers(state, \"error\", handler);\n}\n","// Errors thrown or rejected Promises in \"error\" event handlers are not handled\n// as they are in the webhook event handlers. If errors occur, we log a\n// \"Fatal: Error occured\" message to stdout\nexport function wrapErrorHandler(handler, error) {\n    let returnValue;\n    try {\n        returnValue = handler(error);\n    }\n    catch (error) {\n        console.log('FATAL: Error occured in \"error\" event handler');\n        console.log(error);\n    }\n    if (returnValue && returnValue.catch) {\n        returnValue.catch((error) => {\n            console.log('FATAL: Error occured in \"error\" event handler');\n            console.log(error);\n        });\n    }\n}\n","// @ts-ignore to address #245\nimport AggregateError from \"aggregate-error\";\nimport { wrapErrorHandler } from \"./wrap-error-handler\";\nfunction getHooks(state, eventPayloadAction, eventName) {\n    const hooks = [state.hooks[eventName], state.hooks[\"*\"]];\n    if (eventPayloadAction) {\n        hooks.unshift(state.hooks[`${eventName}.${eventPayloadAction}`]);\n    }\n    return [].concat(...hooks.filter(Boolean));\n}\n// main handler function\nexport function receiverHandle(state, event) {\n    const errorHandlers = state.hooks.error || [];\n    if (event instanceof Error) {\n        const error = Object.assign(new AggregateError([event]), {\n            event,\n            errors: [event],\n        });\n        errorHandlers.forEach((handler) => wrapErrorHandler(handler, error));\n        return Promise.reject(error);\n    }\n    if (!event || !event.name) {\n        throw new AggregateError([\"Event name not passed\"]);\n    }\n    if (!event.payload) {\n        throw new AggregateError([\"Event payload not passed\"]);\n    }\n    // flatten arrays of event listeners and remove undefined values\n    const hooks = getHooks(state, \"action\" in event.payload ? event.payload.action : null, event.name);\n    if (hooks.length === 0) {\n        return Promise.resolve();\n    }\n    const errors = [];\n    const promises = hooks.map((handler) => {\n        let promise = Promise.resolve(event);\n        if (state.transform) {\n            promise = promise.then(state.transform);\n        }\n        return promise\n            .then((event) => {\n            return handler(event);\n        })\n            .catch((error) => errors.push(Object.assign(error, { event })));\n    });\n    return Promise.all(promises).then(() => {\n        if (errors.length === 0) {\n            return;\n        }\n        const error = new AggregateError(errors);\n        Object.assign(error, {\n            event,\n            errors,\n        });\n        errorHandlers.forEach((handler) => wrapErrorHandler(handler, error));\n        throw error;\n    });\n}\n","export function removeListener(state, webhookNameOrNames, handler) {\n    if (Array.isArray(webhookNameOrNames)) {\n        webhookNameOrNames.forEach((webhookName) => removeListener(state, webhookName, handler));\n        return;\n    }\n    if (!state.hooks[webhookNameOrNames]) {\n        return;\n    }\n    // remove last hook that has been added, that way\n    // it behaves the same as removeListener\n    for (let i = state.hooks[webhookNameOrNames].length - 1; i >= 0; i--) {\n        if (state.hooks[webhookNameOrNames][i] === handler) {\n            state.hooks[webhookNameOrNames].splice(i, 1);\n            return;\n        }\n    }\n}\n","import { receiverOn as on, receiverOnAny as onAny, receiverOnError as onError, } from \"./on\";\nimport { receiverHandle as receive } from \"./receive\";\nimport { removeListener } from \"./remove-listener\";\nexport function createEventHandler(options) {\n    const state = {\n        hooks: {},\n    };\n    if (options && options.transform) {\n        state.transform = options.transform;\n    }\n    return {\n        on: on.bind(null, state),\n        onAny: onAny.bind(null, state),\n        onError: onError.bind(null, state),\n        removeListener: removeListener.bind(null, state),\n        receive: receive.bind(null, state),\n    };\n}\n","export function isntWebhook(request, options) {\n    // GitHub sends all events as POST requests\n    if (request.method !== \"POST\") {\n        return true;\n    }\n    // We must match the configured path to allow custom POST routes which include\n    // the webhook route. For example if the webhook route is / then it would be\n    // impossible to define a `POST /my/custom/app` route as the `POST /`.\n    if (typeof request.url !== \"string\" ||\n        request.url.split(\"?\")[0] !== options.path) {\n        return true;\n    }\n    return false;\n}\n","const WEBHOOK_HEADERS = [\n    \"x-github-event\",\n    \"x-hub-signature\",\n    \"x-github-delivery\",\n];\n// https://developer.github.com/webhooks/#delivery-headers\nexport function getMissingHeaders(request) {\n    return WEBHOOK_HEADERS.filter((header) => !(header in request.headers));\n}\n","// @ts-ignore to address #245\nimport AggregateError from \"aggregate-error\";\nexport function getPayload(request) {\n    // If request.body already exists we can stop here\n    // See https://github.com/octokit/webhooks.js/pull/23\n    if (request.body)\n        return Promise.resolve(request.body);\n    return new Promise((resolve, reject) => {\n        let data = \"\";\n        request.setEncoding(\"utf8\");\n        request.on(\"error\", (error) => reject(new AggregateError([error])));\n        request.on(\"data\", (chunk) => (data += chunk));\n        request.on(\"end\", () => {\n            try {\n                resolve(JSON.parse(data));\n            }\n            catch (error) {\n                error.message = \"Invalid JSON\";\n                error.status = 400;\n                reject(new AggregateError([error]));\n            }\n        });\n    });\n}\n","import { createHmac } from \"crypto\";\nexport var Algorithm;\n(function (Algorithm) {\n    Algorithm[\"SHA1\"] = \"sha1\";\n    Algorithm[\"SHA256\"] = \"sha256\";\n})(Algorithm || (Algorithm = {}));\nexport function sign(options, payload) {\n    const { secret, algorithm } = typeof options === \"string\"\n        ? { secret: options, algorithm: Algorithm.SHA1 }\n        : {\n            secret: options.secret,\n            algorithm: options.algorithm || Algorithm.SHA1,\n        };\n    if (!secret || !payload) {\n        throw new TypeError(\"[@octokit/webhooks] secret & payload required\");\n    }\n    if (!Object.values(Algorithm).includes(algorithm)) {\n        throw new TypeError(`[@octokit/webhooks] Algorithm ${algorithm} is not supported. Must be  'sha1' or 'sha256'`);\n    }\n    payload =\n        typeof payload === \"string\" ? payload : toNormalizedJsonString(payload);\n    return `${algorithm}=${createHmac(algorithm, secret)\n        .update(payload)\n        .digest(\"hex\")}`;\n}\nfunction toNormalizedJsonString(payload) {\n    return JSON.stringify(payload).replace(/[^\\\\]\\\\u[\\da-f]{4}/g, (s) => {\n        return s.substr(0, 3) + s.substr(3).toUpperCase();\n    });\n}\n","import { timingSafeEqual } from \"crypto\";\nimport { Buffer } from \"buffer\";\nimport { sign } from \"../sign/index\";\nconst getAlgorithm = (signature) => {\n    return signature.startsWith(\"sha256=\") ? \"sha256\" : \"sha1\";\n};\nexport function verify(secret, eventPayload, signature) {\n    if (!secret || !eventPayload || !signature) {\n        throw new TypeError(\"[@octokit/webhooks] secret, eventPayload & signature required\");\n    }\n    const signatureBuffer = Buffer.from(signature);\n    const algorithm = getAlgorithm(signature);\n    const verificationBuffer = Buffer.from(sign({ secret, algorithm }, eventPayload));\n    if (signatureBuffer.length !== verificationBuffer.length) {\n        return false;\n    }\n    return timingSafeEqual(signatureBuffer, verificationBuffer);\n}\n","import { verify } from \"../verify/index\";\nexport function verifyAndReceive(state, event) {\n    // verify will validate that the secret is not undefined\n    const matchesSignature = verify(state.secret, event.payload, event.signature);\n    if (!matchesSignature) {\n        const error = new Error(\"[@octokit/webhooks] signature does not match event payload and secret\");\n        return state.eventHandler.receive(Object.assign(error, { event, status: 400 }));\n    }\n    return state.eventHandler.receive({\n        id: event.id,\n        name: event.name,\n        payload: event.payload,\n    });\n}\n","import { isntWebhook } from \"./isnt-webhook\";\nimport { getMissingHeaders } from \"./get-missing-headers\";\nimport { getPayload } from \"./get-payload\";\nimport { verifyAndReceive } from \"./verify-and-receive\";\nimport { debug } from \"debug\";\nconst debugWebhooks = debug(\"webhooks:receiver\");\nexport function middleware(state, request, response, next) {\n    if (isntWebhook(request, { path: state.path })) {\n        // the next callback is set when used as an express middleware. That allows\n        // it to define custom routes like /my/custom/page while the webhooks are\n        // expected to be sent to the / root path. Otherwise the root path would\n        // match all requests and would make it impossible to define custom rooutes\n        if (next) {\n            next();\n            return;\n        }\n        debugWebhooks(`ignored: ${request.method} ${request.url}`);\n        response.statusCode = 404;\n        response.end(\"Not found\");\n        return;\n    }\n    const missingHeaders = getMissingHeaders(request).join(\", \");\n    if (missingHeaders) {\n        const error = new Error(`[@octokit/webhooks] Required headers missing: ${missingHeaders}`);\n        return state.eventHandler.receive(error).catch(() => {\n            response.statusCode = 400;\n            response.end(error.message);\n        });\n    }\n    const eventName = request.headers[\"x-github-event\"];\n    const signatureSHA1 = request.headers[\"x-hub-signature\"];\n    const signatureSHA256 = request.headers[\"x-hub-signature-256\"];\n    const id = request.headers[\"x-github-delivery\"];\n    debugWebhooks(`${eventName} event received (id: ${id})`);\n    // GitHub will abort the request if it does not receive a response within 10s\n    // See https://github.com/octokit/webhooks.js/issues/185\n    let didTimeout = false;\n    const timeout = setTimeout(() => {\n        didTimeout = true;\n        response.statusCode = 202;\n        response.end(\"still processing\\n\");\n    }, 9000).unref();\n    return getPayload(request)\n        .then((payload) => {\n        return verifyAndReceive(state, {\n            id: id,\n            name: eventName,\n            payload: payload,\n            signature: signatureSHA256 || signatureSHA1,\n        });\n    })\n        .then(() => {\n        clearTimeout(timeout);\n        if (didTimeout)\n            return;\n        response.end(\"ok\\n\");\n    })\n        .catch((error) => {\n        clearTimeout(timeout);\n        if (didTimeout)\n            return;\n        const statusCode = Array.from(error)[0].status;\n        response.statusCode = statusCode || 500;\n        response.end(error.toString());\n    });\n}\n","import { createEventHandler } from \"../event-handler/index\";\nimport { middleware } from \"./middleware\";\nexport function createMiddleware(options) {\n    if (!options || !options.secret) {\n        throw new Error(\"[@octokit/webhooks] options.secret required\");\n    }\n    const state = {\n        eventHandler: createEventHandler(options),\n        path: options.path || \"/\",\n        secret: options.secret,\n        hooks: {},\n    };\n    const api = middleware.bind(null, state);\n    api.on = state.eventHandler.on;\n    api.removeListener = state.eventHandler.removeListener;\n    return api;\n}\n","import { createEventHandler } from \"./event-handler/index\";\nimport { createMiddleware } from \"./middleware/index\";\nimport { middleware } from \"./middleware/middleware\";\nimport { verifyAndReceive, } from \"./middleware/verify-and-receive\";\nimport { sign } from \"./sign/index\";\nimport { verify } from \"./verify/index\";\n// U holds the return value of `transform` function in Options\nclass Webhooks {\n    constructor(options) {\n        if (!options || !options.secret) {\n            throw new Error(\"[@octokit/webhooks] options.secret required\");\n        }\n        const state = {\n            eventHandler: createEventHandler(options),\n            path: options.path || \"/\",\n            secret: options.secret,\n            hooks: {},\n        };\n        this.sign = sign.bind(null, options.secret);\n        this.verify = verify.bind(null, options.secret);\n        this.on = state.eventHandler.on;\n        this.onAny = state.eventHandler.onAny;\n        this.onError = state.eventHandler.onError;\n        this.removeListener = state.eventHandler.removeListener;\n        this.receive = state.eventHandler.receive;\n        this.middleware = middleware.bind(null, state);\n        this.verifyAndReceive = verifyAndReceive.bind(null, state);\n    }\n}\nconst createWebhooksApi = Webhooks.prototype.constructor;\nexport { createEventHandler, createMiddleware, createWebhooksApi, Webhooks, sign, verify, };\n"],"names":["emitterEventNames","handleEventHandlers","state","webhookName","handler","hooks","push","receiverOn","webhookNameOrNames","Array","isArray","forEach","indexOf","console","warn","charAt","toUpperCase","slice","receiverOnAny","receiverOnError","wrapErrorHandler","error","returnValue","log","catch","getHooks","eventPayloadAction","eventName","unshift","concat","filter","Boolean","receiverHandle","event","errorHandlers","Error","Object","assign","AggregateError","errors","Promise","reject","name","payload","action","length","resolve","promises","map","promise","transform","then","all","removeListener","i","splice","createEventHandler","options","on","bind","onAny","onError","receive","isntWebhook","request","method","url","split","path","WEBHOOK_HEADERS","getMissingHeaders","header","headers","getPayload","body","data","setEncoding","chunk","JSON","parse","message","status","Algorithm","sign","secret","algorithm","SHA1","TypeError","values","includes","toNormalizedJsonString","createHmac","update","digest","stringify","replace","s","substr","getAlgorithm","signature","startsWith","verify","eventPayload","signatureBuffer","Buffer","from","verificationBuffer","timingSafeEqual","verifyAndReceive","matchesSignature","eventHandler","id","debugWebhooks","debug","middleware","response","next","statusCode","end","missingHeaders","join","signatureSHA1","signatureSHA256","didTimeout","timeout","setTimeout","unref","clearTimeout","toString","createMiddleware","api","Webhooks","constructor","createWebhooksApi","prototype"],"mappings":"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"}